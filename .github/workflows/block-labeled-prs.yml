name: Block PRs with "do not merge"
on:
  pull_request:
    types: [opened, edited, synchronize, reopened]
  issue_comment:
    types: [created, edited, deleted]
jobs:
  block_merge:
    runs-on: ubuntu-latest
    steps:
      - name: Check for "do not merge"
        if: github.event_name == 'pull_request'
        run: |
          LABELS=$(jq -r '.pull_request.labels[].name' "$GITHUB_EVENT_PATH")
          if echo "$LABELS" | grep -q "do not merge"; then
            echo "This PR is blocked and cannot be merged."
            exit 1
          fi
      - name: Check for "do not merge" in comments
        if: github.event_name == 'issue_comment'
        run: |
          COMMENT_BODY=$(jq -r '.comment.body' "$GITHUB_EVENT_PATH")
          if echo "$COMMENT_BODY" | grep -q "do not merge"; then
            echo "A comment indicates this PR should not be merged."
            exit 1
          fi
          
